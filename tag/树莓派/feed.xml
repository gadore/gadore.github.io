<?xml version="1.0"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://blog.gadore.top</id>
    <title>千里之豪的格物垛 • Posts by &#34;树莓派&#34; tag</title>
    <link href="https://blog.gadore.top" />
    <updated>2025-10-16T19:52:19.000Z</updated>
    <category term="旅行" />
    <category term="日本" />
    <category term="手机" />
    <category term="程序员" />
    <category term="动漫" />
    <category term="AI" />
    <category term="刷机" />
    <category term="Pixel 5" />
    <category term="LineageOS" />
    <category term="NAS" />
    <category term="相册" />
    <category term="网络" />
    <category term="iPhone" />
    <category term="产品" />
    <category term="独立开发" />
    <category term="iOS" />
    <category term="SwiftUI" />
    <category term="像素风" />
    <category term="安全" />
    <category term="博客" />
    <category term="公租房" />
    <category term="生活" />
    <category term="Swift" />
    <category term="腕表" />
    <category term="游戏" />
    <category term="PCB" />
    <category term="树莓派" />
    <category term="嘉立创" />
    <entry>
        <id>https://blog.gadore.top/archives/raspberrypi-fan-control-pcb/</id>
        <title>用刚学的 PCB 知识做一个优雅的树莓派风扇控制板</title>
        <link rel="alternate" href="https://blog.gadore.top/archives/raspberrypi-fan-control-pcb/"/>
        <content type="html">&lt;blockquote&gt;
&lt;p&gt;首先我不是EE（电子电路工程师），所以对电路一窍不通，但人就是这样，越菜越爱玩。所以如果你是EE的话，不要被我的电路图蠢到（不要骂我）。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;我的家里就好几个树莓派，一些是我大学的时候做小任务的低功耗服务器用，另外一些是工作的时候，自己测试一些硬件用，跑一些边缘服务之类的。&lt;/p&gt;
&lt;h2 id=&#34;树莓派旧风扇长期通电运行报废&#34;&gt;&lt;a href=&#34;#树莓派旧风扇长期通电运行报废&#34; class=&#34;headerlink&#34; title=&#34;树莓派旧风扇长期通电运行报废&#34;&gt;&lt;/a&gt;树莓派旧风扇长期通电运行报废&lt;/h2&gt;&lt;p&gt;我大学期间给树莓派 3B 配备的风扇在通电时间超过三年之后还是在最近寿终正寝了（作为一个4块钱的风扇而言，已经很抗造了），于是我就在想，为什么不做一个根据 CPU 温度动态控制风扇转速的模块，来延长风扇的寿命呢？说干就干。&lt;/p&gt;
&lt;p&gt;众所周知，树莓派最新的 5B 系列已经有了成熟的风扇控制接口了。&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://halo.gadore.top/upload/%E6%A0%91%E8%8E%93%E6%B4%BE5.webp&#34;&gt;&lt;/p&gt;
&lt;p&gt;图片来自：树莓派官网&lt;/p&gt;
&lt;h2 id=&#34;网络上风扇开关电路简单明确，但不够优雅简洁&#34;&gt;&lt;a href=&#34;#网络上风扇开关电路简单明确，但不够优雅简洁&#34; class=&#34;headerlink&#34; title=&#34;网络上风扇开关电路简单明确，但不够优雅简洁&#34;&gt;&lt;/a&gt;网络上风扇开关电路简单明确，但不够优雅简洁&lt;/h2&gt;&lt;p&gt;但我手里的好几个 3B 和 4B 这两个系列都没有呀，我也想要一个更加优雅的、模块化的接口，而不是临时的像这种：&lt;/p&gt;
&lt;p&gt;基础原理图，来自 shumeipai.nxez.com&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://halo.gadore.top/upload/20170713170656938-0.jpg&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://halo.gadore.top/upload/CSDN_luzze__123.jpeg&#34; alt=&#34;CSDNluzze123jpeg&#34;&gt;&lt;/p&gt;
&lt;p&gt;图片来自：CSDN 用户 luzze_123&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://halo.gadore.top/upload/CSDN_qq_40251961.jpeg&#34;&gt;&lt;/p&gt;
&lt;p&gt;图片来自：CSDN 用户 qq_40251961&lt;/p&gt;
&lt;h2 id=&#34;PCB-速成，嘉立创启动！&#34;&gt;&lt;a href=&#34;#PCB-速成，嘉立创启动！&#34; class=&#34;headerlink&#34; title=&#34;PCB 速成，嘉立创启动！&#34;&gt;&lt;/a&gt;PCB 速成，嘉立创启动！&lt;/h2&gt;&lt;p&gt;但我不会画电路板，更不了解各种电子电路相关的知识，只好去折磨 AI 了 😄。&lt;/p&gt;
&lt;p&gt;但其实每个人都是有一定的电路基础的，正负极、开关。所以我选择了更加速成的方式：&lt;br&gt;&lt;a href=&#34;https://www.bilibili.com/video/BV1J24y1Z7cY/&#34;&gt;&lt;strong&gt;【保姆级】二十分钟零基础PCB绘制打样一条龙教程（立创EDA专业版）&lt;/strong&gt;&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;只需要按照这个视频教程，你就可以在半小时左右学会最基础的 PCB 板的绘制技巧，我也是顺利地完成了第一版绘制&lt;/p&gt;
&lt;h3 id=&#34;第一版电路图&#34;&gt;&lt;a href=&#34;#第一版电路图&#34; class=&#34;headerlink&#34; title=&#34;第一版电路图&#34;&gt;&lt;/a&gt;第一版电路图&lt;/h3&gt;&lt;p&gt;&lt;img src=&#34;https://halo.gadore.top/upload/iShot_2025-10-11_14.46.51.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://halo.gadore.top/upload/iShot_2025-10-11_14.47.15.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://halo.gadore.top/upload/iShot_2025-10-11_14.47.33.png&#34;&gt;  &lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://halo.gadore.top/upload/iShot_2025-10-16_19.24.08.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;如果你是比较懂电路的话，你肯定已经看到问题所在了，没错，我把三极管放在了 5V 正极了，导致板子到手后风扇的转速非常慢，有时候甚至转不起来，即使已经通过 GPIO 把电路导通了，风扇还是不转或者转的非常慢，我就不瞎分析了，放出 AI 的分析：&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;&lt;strong&gt;把 8050 放在正极（高侧）当“开关”用了&lt;/strong&gt; —— 8050 是 NPN 晶体管，做高侧开关时它会工作在发射跟随（emitter-follower）模式，发射极电压 ≈ 基极电压 − 0.7V。GPIO 给的是 3.3V，发射极最多 ~2.6V，风扇的电源是 5V → 风扇只拿到 ~2.6V，自然转得很慢。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;p&gt;我理解下来就是：三极管放正极会对电压电流有较大损耗，导致风扇工作所需功率不足。&lt;/p&gt;
&lt;h3 id=&#34;第二版电路图&#34;&gt;&lt;a href=&#34;#第二版电路图&#34; class=&#34;headerlink&#34; title=&#34;第二版电路图&#34;&gt;&lt;/a&gt;第二版电路图&lt;/h3&gt;&lt;p&gt;于是重新去嘉立创领券，重新打板，重新焊接电路，重新测试，可以了！！！&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://halo.gadore.top/upload/%E6%88%AA%E5%B1%8F2025-10-16%2017.53.58.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;再配合 Python 脚本，和亿点点配置，一个全自动的风扇控制模块就做好了！&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://halo.gadore.top/upload/IMG_0568.jpg&#34;&gt;&lt;/p&gt;
&lt;p&gt;安装效果图&lt;/p&gt;
&lt;p&gt;模块大小示意（对比 Type-C 接口）&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://halo.gadore.top/upload/IMG_0569.jpg&#34;&gt;&lt;/p&gt;
&lt;p&gt;总花销：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;买电子元器件（S8050、排针、排母）：9元&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;电烙铁基础套装（松香、焊锡丝、锡棉，支架）36.9元&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;然而这一趟折腾下来，我发现花销已经足够我买好多小风扇了，好在电烙铁可以反复使用，电子元器件也只消耗了一小部份，以后折腾其他东西也能用～&lt;/p&gt;
&lt;h2 id=&#34;解除-GPIO-14-的串口占用，用来当做开关信号&#34;&gt;&lt;a href=&#34;#解除-GPIO-14-的串口占用，用来当做开关信号&#34; class=&#34;headerlink&#34; title=&#34;解除 GPIO 14 的串口占用，用来当做开关信号&#34;&gt;&lt;/a&gt;解除 GPIO 14 的串口占用，用来当做开关信号&lt;/h2&gt;&lt;p&gt;当前这个模块占地较小，但也有代价，它使用的是GPIO 14进行电路开关控制，GPIO 14 在树莓派上原本是被串口通信功能占用，如果你跟我一样不使用串口功能，可以这样关闭掉：&lt;br&gt;&lt;code&gt;sudo raspi-config&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;Interface Options → Serial Port&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;Would you like a login shell to be accessible over serial?&lt;/code&gt; → &lt;strong&gt;No&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;&lt;code&gt;Would you like the serial port hardware to be enabled?&lt;/code&gt; → &lt;strong&gt;No&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;完成后退出并选择 &lt;strong&gt;Finish&lt;/strong&gt;，允许它重启。&lt;/p&gt;
&lt;p&gt;重启后：&lt;/p&gt;
&lt;p&gt;sudo vim &amp;#x2F;boot&amp;#x2F;firmware&amp;#x2F;config.txt&lt;/p&gt;
&lt;p&gt;确认或添加以下内容（顺序重要）：&lt;/p&gt;
&lt;figure class=&#34;highlight ini&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 禁用蓝牙，释放 UART&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attr&#34;&gt;dtoverlay&lt;/span&gt;=disable-bt&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 确保主 UART 关闭&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;attr&#34;&gt;enable_uart&lt;/span&gt;=&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;


&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;sudo systemctl &lt;span class=&#34;built_in&#34;&gt;disable&lt;/span&gt; hciuart.service&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;sudo systemctl mask hciuart.service&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;


&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;sudo reboot&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;


&lt;p&gt;验证 GPIO 14 状态：&lt;/p&gt;
&lt;p&gt;&lt;code&gt;pinctrl get 14&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;应显示：&lt;/p&gt;
&lt;figure class=&#34;highlight bash&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;GPIO 14: level=0 func=INPUT&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;


&lt;p&gt;（或类似 &lt;code&gt;function INPUT&lt;/code&gt;），&lt;strong&gt;没有出现&lt;/strong&gt; &lt;code&gt;ALT0&lt;/code&gt; &lt;strong&gt;&amp;#x2F;&lt;/strong&gt; &lt;code&gt;TXD0&lt;/code&gt; &lt;strong&gt;&amp;#x2F;&lt;/strong&gt; &lt;code&gt;RXD0&lt;/code&gt;。&lt;/p&gt;
&lt;p&gt;此时即可用作普通 GPIO。&lt;/p&gt;
&lt;h2 id=&#34;如果你需要串口功能，则可以使用另一种方案代替&#34;&gt;&lt;a href=&#34;#如果你需要串口功能，则可以使用另一种方案代替&#34; class=&#34;headerlink&#34; title=&#34;如果你需要串口功能，则可以使用另一种方案代替&#34;&gt;&lt;/a&gt;如果你需要串口功能，则可以使用另一种方案代替&lt;/h2&gt;&lt;p&gt;这是另一个版本，它不占用串口功能，使用 GPIO 4 进行开关控制，最终组件也会相对应长一些&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://halo.gadore.top/upload/%E6%88%AA%E5%B1%8F2025-10-16%2017.57.17.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://halo.gadore.top/upload/%E6%88%AA%E5%B1%8F2025-10-16%2018.02.05.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://halo.gadore.top/upload/iShot_2025-10-16_19.41.25.png&#34;&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://halo.gadore.top/upload/IMG_0571.png&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;风扇控制脚本&#34;&gt;&lt;a href=&#34;#风扇控制脚本&#34; class=&#34;headerlink&#34; title=&#34;风扇控制脚本&#34;&gt;&lt;/a&gt;风扇控制脚本&lt;/h2&gt;&lt;p&gt;Python 脚本：&lt;/p&gt;
&lt;figure class=&#34;highlight python&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;32&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;33&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;34&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;35&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;36&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;37&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;38&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;39&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;40&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;41&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;42&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;43&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;44&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;45&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;46&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;47&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;48&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;49&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;50&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;51&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;52&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;53&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;54&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;55&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;56&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;57&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;58&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;59&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;60&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;61&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;62&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;63&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;64&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;65&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;66&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;67&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;68&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;69&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;70&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;71&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;72&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;73&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;74&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;75&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;76&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;77&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;78&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; RPi.GPIO &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; GPIO&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; time&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; signal&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;import&lt;/span&gt; sys&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 控制风扇的GPIO（BCM编号）&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;FAN_GPIO = &lt;span class=&#34;number&#34;&gt;14&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 温度阈值（摄氏度）&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;HIGH_TEMP = &lt;span class=&#34;number&#34;&gt;45.0&lt;/span&gt;  &lt;span class=&#34;comment&#34;&gt;# 高于此温度开启风扇&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;LOW_TEMP = &lt;span class=&#34;number&#34;&gt;42.0&lt;/span&gt;   &lt;span class=&#34;comment&#34;&gt;# 低于此温度关闭风扇&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 检查间隔（秒）&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;CHECK_INTERVAL = &lt;span class=&#34;number&#34;&gt;5&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 设置GPIO模式&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;GPIO.setmode(GPIO.BCM)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;GPIO.setup(FAN_GPIO, GPIO.OUT)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 初始状态关闭风扇&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;GPIO.output(FAN_GPIO, GPIO.HIGH)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;fan_status = &lt;span class=&#34;literal&#34;&gt;False&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 获取CPU温度的函数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;get_cpu_temperature&lt;/span&gt;():&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;built_in&#34;&gt;open&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;#x27;/sys/class/thermal/thermal_zone0/temp&amp;#x27;&lt;/span&gt;, &lt;span class=&#34;string&#34;&gt;&amp;#x27;r&amp;#x27;&lt;/span&gt;) &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; f:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            temp = &lt;span class=&#34;built_in&#34;&gt;float&lt;/span&gt;(f.read()) / &lt;span class=&#34;number&#34;&gt;1000.0&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; temp&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;except&lt;/span&gt; Exception &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; e:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;f&amp;quot;无法读取CPU温度: &lt;span class=&#34;subst&#34;&gt;&amp;#123;e&amp;#125;&lt;/span&gt;&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;literal&#34;&gt;None&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 控制风扇的函数&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;control_fan&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;temperature&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;global&lt;/span&gt; fan_status&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; temperature &amp;gt;= HIGH_TEMP &lt;span class=&#34;keyword&#34;&gt;and&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;not&lt;/span&gt; fan_status:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        GPIO.output(FAN_GPIO, GPIO.HIGH)  &lt;span class=&#34;comment&#34;&gt;# 开启风扇&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        fan_status = &lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;f&amp;quot;温度: &lt;span class=&#34;subst&#34;&gt;&amp;#123;temperature&amp;#125;&lt;/span&gt;°C - 风扇开启&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;elif&lt;/span&gt; temperature &amp;lt;= LOW_TEMP &lt;span class=&#34;keyword&#34;&gt;and&lt;/span&gt; fan_status:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        GPIO.output(FAN_GPIO, GPIO.LOW)  &lt;span class=&#34;comment&#34;&gt;# 关闭风扇&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        fan_status = &lt;span class=&#34;literal&#34;&gt;False&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;f&amp;quot;温度: &lt;span class=&#34;subst&#34;&gt;&amp;#123;temperature&amp;#125;&lt;/span&gt;°C - 风扇关闭&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        status = &lt;span class=&#34;string&#34;&gt;&amp;quot;开启&amp;quot;&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; fan_status &lt;span class=&#34;keyword&#34;&gt;else&lt;/span&gt; &lt;span class=&#34;string&#34;&gt;&amp;quot;关闭&amp;quot;&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;f&amp;quot;温度: &lt;span class=&#34;subst&#34;&gt;&amp;#123;temperature&amp;#125;&lt;/span&gt;°C - 风扇保持&lt;span class=&#34;subst&#34;&gt;&amp;#123;status&amp;#125;&lt;/span&gt;&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 优雅退出处理&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;def&lt;/span&gt; &lt;span class=&#34;title function_&#34;&gt;signal_handler&lt;/span&gt;(&lt;span class=&#34;params&#34;&gt;sig, frame&lt;/span&gt;):&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;\n正在关闭程序...&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    GPIO.output(FAN_GPIO, GPIO.LOW)  &lt;span class=&#34;comment&#34;&gt;# 确保风扇关闭&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    GPIO.cleanup()  &lt;span class=&#34;comment&#34;&gt;# 清理GPIO资源&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;风扇已关闭，程序退出&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    sys.exit(&lt;span class=&#34;number&#34;&gt;0&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 注册信号处理&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;signal.signal(signal.SIGINT, signal_handler)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;signal.signal(signal.SIGTERM, signal_handler)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 主循环&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;开始监控CPU温度并控制风扇...&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;f&amp;quot;温度阈值: 高于&lt;span class=&#34;subst&#34;&gt;&amp;#123;HIGH_TEMP&amp;#125;&lt;/span&gt;°C开启, 低于&lt;span class=&#34;subst&#34;&gt;&amp;#123;LOW_TEMP&amp;#125;&lt;/span&gt;°C关闭&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;&amp;quot;按 Ctrl+C 退出程序&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;try&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;keyword&#34;&gt;while&lt;/span&gt; &lt;span class=&#34;literal&#34;&gt;True&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        temperature = get_cpu_temperature()&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        &lt;span class=&#34;keyword&#34;&gt;if&lt;/span&gt; temperature &lt;span class=&#34;keyword&#34;&gt;is&lt;/span&gt; &lt;span class=&#34;keyword&#34;&gt;not&lt;/span&gt; &lt;span class=&#34;literal&#34;&gt;None&lt;/span&gt;:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;            control_fan(temperature)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;        time.sleep(CHECK_INTERVAL)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;except&lt;/span&gt; KeyboardInterrupt:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    signal_handler(&lt;span class=&#34;literal&#34;&gt;None&lt;/span&gt;, &lt;span class=&#34;literal&#34;&gt;None&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;keyword&#34;&gt;except&lt;/span&gt; Exception &lt;span class=&#34;keyword&#34;&gt;as&lt;/span&gt; e:&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    &lt;span class=&#34;built_in&#34;&gt;print&lt;/span&gt;(&lt;span class=&#34;string&#34;&gt;f&amp;quot;程序运行出错: &lt;span class=&#34;subst&#34;&gt;&amp;#123;e&amp;#125;&lt;/span&gt;&amp;quot;&lt;/span&gt;)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    GPIO.output(FAN_GPIO, GPIO.LOW)&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;    GPIO.cleanup()&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;Python&lt;/p&gt;
&lt;h2 id=&#34;自动化服务配置&#34;&gt;&lt;a href=&#34;#自动化服务配置&#34; class=&#34;headerlink&#34; title=&#34;自动化服务配置&#34;&gt;&lt;/a&gt;自动化服务配置&lt;/h2&gt;&lt;figure class=&#34;highlight makefile&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;13&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;14&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;15&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;16&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;17&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;18&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;19&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;20&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;21&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;22&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;23&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;24&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;25&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;26&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;27&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;28&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;29&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;30&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;31&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;[Unit]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Description=Fan control Service&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;After=network.target&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[Service]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Type=simple&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;WorkingDirectory= &lt;span class=&#34;comment&#34;&gt;# 这里替换成python脚本所在目录&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;ExecStart=/usr/bin/python3 &lt;span class=&#34;comment&#34;&gt;# 这里替换成python脚本的绝对路径&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Restart=always&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;RestartSec=10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;StandardOutput=syslog&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;StandardError=syslog&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;SyslogIdentifier=fan-control&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;comment&#34;&gt;# 环境变量（如果需要）&lt;/span&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Environment=PYTHONUNBUFFERED=1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;[Install]&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;WantedBy=multi-user.target&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;

&lt;p&gt;Makefile&lt;/p&gt;
&lt;p&gt;把上边这个脚本保存到&lt;/p&gt;
&lt;p&gt;&lt;code&gt;/etc/systemd/system/fan-control.service&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;然后依次执行:&lt;/p&gt;
&lt;p&gt;重新加载服务文件&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudo systemctl daemon-reload&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;启动风扇控制脚本服务&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudo systemctl start fan-control.service&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;检查运行状态&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudo systemctl status fan-control.service&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;设置服务开机自启动&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudo systemctl enable fan-control.service&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;如果发现服务启动异常，可以通过这个命令来查看异常原因&lt;/p&gt;
&lt;p&gt;&lt;code&gt;sudo journalctl -u fan-control.service -n 50&lt;/code&gt;&lt;/p&gt;
&lt;h2 id=&#34;效果&#34;&gt;&lt;a href=&#34;#效果&#34; class=&#34;headerlink&#34; title=&#34;效果&#34;&gt;&lt;/a&gt;效果&lt;/h2&gt;&lt;figure class=&#34;highlight plaintext&#34;&gt;&lt;table&gt;&lt;tr&gt;&lt;td class=&#34;gutter&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;1&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;2&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;3&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;4&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;5&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;6&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;7&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;8&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;9&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;10&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;11&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;12&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;td class=&#34;code&#34;&gt;&lt;pre&gt;&lt;span class=&#34;line&#34;&gt;Oct 16 13:23:42 raspberrypi fan-control[2004]: 温度: 44.008°C - 风扇保持关闭&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Oct 16 13:23:47 raspberrypi fan-control[2004]: 温度: 44.546°C - 风扇保持关闭&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Oct 16 13:23:52 raspberrypi fan-control[2004]: 温度: 45.084°C - 风扇开启&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Oct 16 13:23:57 raspberrypi fan-control[2004]: 温度: 45.084°C - 风扇保持开启&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Oct 16 13:24:02 raspberrypi fan-control[2004]: 温度: 44.008°C - 风扇保持开启&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Oct 16 13:24:07 raspberrypi fan-control[2004]: 温度: 43.47°C - 风扇保持开启&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Oct 16 13:24:12 raspberrypi fan-control[2004]: 温度: 43.47°C - 风扇保持开启&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Oct 16 13:24:17 raspberrypi fan-control[2004]: 温度: 42.932°C - 风扇保持开启&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Oct 16 13:24:22 raspberrypi fan-control[2004]: 温度: 41.856°C - 风扇关闭&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Oct 16 13:24:27 raspberrypi fan-control[2004]: 温度: 41.856°C - 风扇保持关闭&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Oct 16 13:24:32 raspberrypi fan-control[2004]: 温度: 41.856°C - 风扇保持关闭&lt;/span&gt;&lt;br&gt;&lt;span class=&#34;line&#34;&gt;Oct 16 13:24:37 raspberrypi fan-control[2004]: 温度: 41.318°C - 风扇保持关闭&lt;/span&gt;&lt;br&gt;&lt;/pre&gt;&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&lt;/figure&gt;


&lt;h2 id=&#34;备注&#34;&gt;&lt;a href=&#34;#备注&#34; class=&#34;headerlink&#34; title=&#34;备注&#34;&gt;&lt;/a&gt;备注&lt;/h2&gt;&lt;ul&gt;
&lt;li&gt;&lt;p&gt;&lt;a href=&#34;https://www.jlc.com/newOrder/#/collectCoupons?spm=JLC.MEMBER&#34;&gt;嘉立创领券链接&lt;/a&gt;，感谢嘉立创！😄&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;&lt;p&gt;我跑通了这个PCB验证，也写完了这篇文章后，才发现很久之前（2021年）就有其他人做过：可以参考「&lt;a href=&#34;https://www.quarkbook.com/?p=1194&#34;&gt;夸克之书&lt;/a&gt;」的文章，哎，早点儿看到就能少走很多弯路了。&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
</content>
        <category term="PCB" />
        <category term="树莓派" />
        <category term="嘉立创" />
        <updated>2025-10-16T19:52:19.000Z</updated>
    </entry>
</feed>
